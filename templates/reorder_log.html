{% extends 'base.html' %}
{% block content %}

<div class="page-toolbar">
  <div class="page-toolbar__title">
    <h2>Reorder Log</h2>
    <div class="page-toolbar__subtitle">All reorder requests and approval history.</div>
  </div>
  <div class="page-toolbar__actions">
    <a href="{{ url_for('reorder_log_export_xlsx') }}" class="btn btn--secondary">Download Excel</a>
    <a href="{{ url_for('reorder_log_export_pdf') }}" class="btn btn--secondary">Download PDF</a>
  </div>
</div>
{% if not log_rows %}
  <div class="empty-state">
    <div class="empty-state__title">No reorder history yet</div>
    <div class="empty-state__hint">Once requests are submitted and approved, youâ€™ll see them here.</div>
  </div>
{% else %}
  <div class="table-wrap table-wrap--compact">
  <table>
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>User</th>
        <th>IP</th>
        <th>Vendor</th>
        <th>PO #</th>
        <th>Delivery</th>
        <th>Pickup By</th>
        <th>Needed By</th>
        <th>Items</th>
        <th>Status</th>
        <th>Notes</th>
        <th>Internal Notes</th>
        <th>Approved Timestamp</th>
        <th>Approved By</th>
        <th>Approved IP</th>
      </tr>
    </thead>
    <tbody>
      {% for row in log_rows %}
      <tr>
        <td class="table-cell--nowrap">{{ row['Timestamp'] }}</td>
        <td>{{ row['User'] }}</td>
        <td>{{ row['IP'] }}</td>
        <td class="table-cell--nowrap">{{ row['Vendor'] }}</td>
        <td>{{ row.get('PO Number', '') }}</td>
        <td>{{ row.get('Delivery Method', '') }}</td>
        <td>{{ row.get('Pickup By', '') }}</td>
        <td>{{ row.get('Needed By', '') }}</td>
        <td>{{ row['Items'] }}</td>
        <td>
          {% if row['Status'] %}
            <span class="status-badge status-{{ row['Status'] }}">{{ row['Status'] }}</span>
          {% else %}
            
          {% endif %}
        </td>
        <td>{{ row['Notes'] }}</td>
        <td>{{ row['Internal Notes'] if 'Internal Notes' in row else '' }}</td>
        <td>{{ row['Approved Timestamp'] }}</td>
        <td>{{ row['Approved By'] }}</td>
        <td>{{ row['Approved IP'] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
{% endif %}
{% endblock %}
